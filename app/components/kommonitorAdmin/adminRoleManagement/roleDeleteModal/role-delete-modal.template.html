<div class="modal fade" id="modal-delete-roles" role="dialog">
	<div class="modal-dialog modal-xl">
		<div class="modal-content">

			<div align="center">
				<div class="loading-overlay-admin-panel ng-hide" ng-show="loadingData">
					<span class="glyphicon glyphicon-refresh icon-spin"></span>
				</div>
			</div>


			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">Organisationseinheiten l&ouml;schen</h4>
			</div>
			<div class="modal-body">

				<h4><b>Sollen die folgenden Organisationseinheiten wirklich gel&ouml;scht werden?</b></h4>

                <div class="alert alert-danger" ng-if="organizationalChildrenEffected">
                    Beachten Sie, dass diese Organisationseinheit &uuml;ber Untergruppen verf&uuml;gt. Bitte l&ouml;schen Sie daher zun√§chst die Untergruppen.
                </div>

				<div ng-if="elementsToDelete.length > 0">
                    <table class="table table-bordered table-condensed"
							style="overflow:auto; font-size: 11px;">
							<thead>
								<tr>
									<th>Name</th>
									<th>Organisations-ID</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="dataset in elementsToDelete">
									<td><span ng-class="{'organizationalUnit-subGroup-item' : dataset.subGroup }"><b>{{dataset.name}}</b></span></td>
									<td>{{dataset.organizationalUnitId}}</td>
								</tr>

							</tbody>
						</table>
				</div>

				<div ng-if="! elementsToDelete.length > 0">
					<pre>kein Datensatz zum L&ouml;schen markiert. Mindestens ein Datensatz muss markiert werden.</pre>
				</div>

				<div ng-if="elementsToDelete.length > 0 && (affectedGeoresources.length > 0 || affectedIndicators.length > 0 || affectedSpatialUnits.length > 0)">
					<div class="alert alert-danger">
                        <h3>ACHTUNG!</h3>
                        Es existieren Resourcen, welche durch diese Organisationseinheit(en) abgesichert sind. Solange diese Verkn&uuml;pfungen existieren, ist ein L&ouml;schen der entsprechende Organisationseinheit(en) nicht m&ouml;glich. <br>
                        Bitte l&ouml;sen Sie zuerst die im folgenden aufgef&uuml;hrten Verkn&uuml;pfungen.
                    </div>
                    
					<div ng-if="affectedSpatialUnits.length > 0">
                        <h4>Betroffene Raumeinheiten</h4>
						<table class="table table-bordered table-condensed"
							style="width:100%; overflow:auto; font-size: 11px;">
							<thead>
								<tr>
									<th>Raumeinheit-ID</th>
									<th>Raumeinheit-Name</th>
									<th>verkn&uuml;pfte Einheiten</th>
								</tr>
							</thead>

							<tbody>
								<tr ng-repeat="entry in affectedSpatialUnits">
									<td>{{entry.spatialUnitId}}</td>
									<td>{{entry.spatialUnitLevel}}</td>
									<td>
                                        <span ng-repeat="connectedItem in entry.connectedItems">
                                            <div ng-if="!connectedItem.subGroup"><b>{{connectedItem.name}}</b>-{{connectedItem.permission}}</div>
                                            <div ng-if="connectedItem.subGroup"><span class="organizationalUnit-subGroup-item"><b>{{connectedItem.name}}</b></span>-{{connectedItem.permission}}</div>
                                        </span>
                                    </td>
								</tr>

							</tbody>
						</table>
					</div>

					<div ng-if="affectedGeoresources.length > 0">
                        <h4>Betroffene Georessourcen</h4>
						<table class="table table-bordered table-condensed"
							style="width:100%; overflow:auto; font-size: 11px;">
							<thead>
								<tr>
									<th>Georessourcen-ID</th>
									<th>Georessourcen-Name</th>
									<th>verkn&uuml;pfte Einheiten</th>
								</tr>
							</thead>

							<tbody>
								<tr ng-repeat="entry in affectedGeoresources">
									<td>{{entry.georesourceId}}</td>
									<td>{{entry.datasetName}}</td>
									<td>
                                        <span ng-repeat="connectedItem in entry.connectedItems">
                                            <div ng-if="!connectedItem.subGroup"><b>{{connectedItem.name}}</b>-{{connectedItem.permission}}</div>
                                            <div ng-if="connectedItem.subGroup"><span class="organizationalUnit-subGroup-item"><b>{{connectedItem.name}}</b></span>-{{connectedItem.permission}}</div>
                                        </span>
                                    </td>
								</tr>

							</tbody>
						</table>
					</div>

					<div ng-if="affectedIndicators.length > 0">
                        <h4>Betroffene Indikatoren</h4>
						<table class="table table-bordered table-condensed"
							style="width:100%; overflow:auto; font-size: 11px;">
							<thead>
								<tr>
									<th>Indikatoren-ID</th>
									<th>Indikatoren-Name</th>
									<th>verkn&uuml;pfte Einheiten zu Metadatensatz</th>
									<th>verkn&uuml;pfte Einheiten pro verkn&uuml;pfter Raumebene</th>
								</tr>
							</thead>

							<tbody>
								<tr ng-repeat="entry in affectedIndicators">
									<td>{{entry.indicatorId}}</td>
									<td>{{entry.indicatorName}}</td>
									<td>
                                        <span ng-repeat="connectedItem in entry.connectedItems">
                                            <div ng-if="!connectedItem.subGroup"><b>{{connectedItem.name}}</b>-{{connectedItem.permission}}</div>
                                            <div ng-if="connectedItem.subGroup"><span class="organizationalUnit-subGroup-item"><b>{{connectedItem.name}}</b></span>-{{connectedItem.permission}}</div>
                                        </span>
                                    </td>
									<td>
										<div ng-if="entry.connectedSpatialUnits.length > 0">
											<span ng-repeat="spatialUnit in entry.connectedSpatialUnits" class="spatial-unit-list-item">
												{{spatialUnit.name}}:
                                                <span ng-repeat="spatialUnitIds in spatialUnit.ids">
                                                    <div ng-if="!spatialUnitIds.subGroup"><b>{{spatialUnitIds.name}}</b>-{{spatialUnitIds.permission}}</div>
                                                    <div ng-if="spatialUnitIds.subGroup"><span class="organizationalUnit-subGroup-item"><b>{{spatialUnitIds.name}}</b></span>-{{spatialUnitIds.permission}}</div>
                                                </span>
											</span><br>
										</div>
									</td>
									<!-- <td ng-bind-html="entry.connectedSpatialUnits | formatJson"></td> -->
								</tr>

							</tbody>
						</table>
					</div>

				</div>

				<br />
				<hr>

				<!--
				// Data Management API deletes group and roles, so nothing to do here, anymore.
				// However, Data Management API maybe later provides a query parameter to control Keycloak entity handling.
				-->
				<!-- <div class="row vertical-align">
					<div class="col-md-3 col-sm-6 col-xs-12">
						<div class="form-group">
							<label>Gleichnamige Keycloak-Rolle mit l&ouml;schen?*</label>
							<label class="switch">
								<input type="checkbox" value="deleteCorrespondingKeycloakGroup"
									ng-model="deleteCorrespondingKeycloakGroup">
								<span class="switchslider round"></span>
							</label>

							<div class="help-block">
								<p>Angabe, ob die assoziierten Einheiten auch aus der Keycloak-Instanz zu l&ouml;schen ist.
								</p>
							</div>
							<div class="help-block with-errors"></div>
						</div>
					</div>
				</div> -->

			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default pull-left" data-dismiss="modal">Schlie&szlig;en</button>
				<button type="button" class="btn btn-danger" ng-click="deleteOrganizationalUnits()"
					ng-disabled="isDeleteDisabled()">Unwiderruflich l&ouml;schen</button>
			</div>

			<div id="ouDeleteSuccessAlert" style="position: absolute; bottom: 0px; width: 100%;" hidden
				class="alert alert-success alert-dismissable">
				<button type="button" class="close" ng-click="hideSuccessAlert()" aria-hidden="true">&times;</button>
				<h4><i class="icon fa fa-check"></i>Folgende Organisationseinheiten wurde erfolgreich gel&ouml;scht</h4>
				<ul>
					<li ng-repeat="dataset in successfullyDeletedDatasets">{{dataset.name}}</li>
				</ul>
			</div>

			<div id="ouDeleteErrorAlert" style="position: absolute; bottom: 0px; width: 100%;" hidden
				class="alert alert-danger alert-dismissable">
				<button type="button" class="close" ng-click="hideErrorAlert()" aria-hidden="true">&times;</button>
				<h4><i class="icon fa fa-ban"></i>L&ouml;schen fehlgeschlagen</h4>
				Folgende Datens&auml;tze konnten nicht gel&ouml;scht werden.
				<br />
				<table class="table table-bordered table-condensed" style="width:100%; overflow:auto; font-size: 11px;">
					<thead>
						<tr>
							<th>Name</th>
							<th>Fehlermeldung</th>
						</tr>
					</thead>

					<tbody>
						<tr ng-repeat="dataset in failedDatasetsAndErrors">
							<td>{{dataset[0].name}}</td>
							<td ng-bind-html="dataset[1]"></td>
						</tr>

					</tbody>
				</table>

			</div>

		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
<!-- /.modal -->