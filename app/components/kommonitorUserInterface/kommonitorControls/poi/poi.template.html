<div id="poi">

	<div align="center">
		<div class="loading-overlay-sidebar-small ng-hide" ng-show="loadingData">
			<span class="glyphicon glyphicon-refresh icon-spin"></span>
		</div>
	</div>

	<p></p>

	<div class="box box-primary">
		<div class="box-header with-border">
			<h3 class="box-title">Georessourcenauswahl</h3>

			<div class="box-tools pull-right">
				<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
				</button>
			</div>
		</div>
		<div class="box-body">

			<div align="center">

				<b title="Checkbox zur Wahl, ob die einzelnen Punkte eines POI Layers geclustered werden sollen">Points
					of Interest clustern</b> (Zusammenfassung mehrerer Punkte je nach Zoomstufe)
				&nbsp;
				<label class="switch" style="top: -5px; margin-top: 5px;">
					<input type="checkbox" value="useCluster" ng-model="useCluster" ng-change="refreshPoiLayers()"
						checked>
					<span class="switchslider round"></span>
				</label>

				<br />

				<label style="margin-bottom: 10px;">
					<b title="Auswahl zur Größe der POI-Marker">Größe der Points
						of Interest</b>
					&nbsp;
					<select 
						ng-options="item as item.label for item in $ctrl.kommonitorDataExchangeServiceInstance.POISizes track by item.id" 
						ng-model="$ctrl.kommonitorDataExchangeServiceInstance.selectedPOISize"
						ng-change="refreshPoiLayers()">
					</select>
				</label>

				<br />

				<b ng-if="!$ctrl.kommonitorDataExchangeServiceInstance.spatialFilterIsApplied"
					 title="Checkbox zur Wahl, ob die gesetzten räumlichen Filter auf die POI angewendet werden sollen"
					 style="color: #777">
					Räumliche Filter anwenden
				</b>
				<b ng-if="$ctrl.kommonitorDataExchangeServiceInstance.spatialFilterIsApplied" 
					 title="Checkbox zur Wahl, ob die gesetzten räumlichen Filter auf die POI angewendet werden sollen">
					Räumliche Filter anwenden
				</b>
				&nbsp;
				<label class="switch" style="top: -5px; margin-top: 5px;">
					<input type="checkbox" value="useSpatialFilterForGeoressources" ng-model="useSpatialFilterForGeoressources" ng-change="refreshPoiLayers()"
						 ng-disabled="!$ctrl.kommonitorDataExchangeServiceInstance.spatialFilterIsApplied">
					<span class="switchslider round"></span>
				</label>

				

				<!-- for now hide menu to change date selection for georesourcs as it might be more confusing than helpful -->
				<!-- <div>
					<hr>
					<br />
					<label>Art der Datumsdefinition zum Abruf eines Datensatzes</label>
					<div class="form-group">
						<label class="radio-inline"><input type="radio" name="dateSelectionType"
								ng-value="dateSelectionType_valueIndicator" ng-model="dateSelectionType.selectedDateType"
								ng-click="onClickUseIndicatorTimestamp()">Datum des aktuellen Indikators</label>
						<label class="radio-inline"><input type="radio" name="dateSelectionType"
								ng-value="dateSelectionType_valueManual"
								ng-model="dateSelectionType.selectedDateType">manuelles Datum
							<div ng-hide="!(dateSelectionType.selectedDateType === dateSelectionType_valueManual)"
								class="input-group date">
								<div class="input-group-addon">
									<i class="far fa-calendar-alt"></i>
								</div>
								<input type="text" ng-model="selectedDate_manual" ng-change="onChangeManualDate()"
									class="form-control pull-right" placeholder="YYYY-MM-DD" id="manualDateDatepicker"
									required>
							</div>
						</label>
						<label class="radio-inline"><input type="radio" name="dateSelectionType"
								ng-value="dateSelectionType_valuePerDataset"
								ng-model="dateSelectionType.selectedDateType">pro Datensatz</label>
					</div>
				</div>			 -->

			</div>

			<hr>
			<br />

			<div class="input-group">
				<span class="input-group-addon"><i class="fas fa-filter"></i></span>
				<input type="text" class="form-control input-sm" placeholder="Stichwortfilter"
					ng-model="georesourceNameFilter.value" ng-model-options="{debounce: 500, blur: 0}"
					ng-change="$ctrl.kommonitorDataExchangeServiceInstance.onChangeGeoresourceKeywordFilter(georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)">
			</div>

			<br />

			<uib-tabset active="0">
				<uib-tab index="0" heading="Datenkatalog">

					<div class="just-padding">

						<!-- <label>Filtern nach Typ</label>
							<br/> -->

						<!-- <div class="btn-group btn-group-justified"> -->
						<table class="table" style="width:100%;" ng-if="(enabledGeoresourcesInfrastructure.length + enabledGeoresourcesGeoservices.length) > 1">
							<tr>
                                <th ng-if="enabledGeoresourcesInfrastructure.length > 0" colspan="{{enabledGeoresourcesInfrastructure.length}}" class="text-center"><b>Infrastruktur</b></th>
                                <th ng-if="enabledGeoresourcesGeoservices.length > 0" colspan="{{enabledGeoresourcesGeoservices.length}}" class="text-center"><b>Geodaten-Dienste</b></th>
							</tr>
							<tr>
                                <th ng-if="isGeoresourceInfrastructureEnabled('poi')" class="text-center"><b>Punktdaten</b></th>
                                <th ng-if="isGeoresourceInfrastructureEnabled('loi')" class="text-center"><b>Liniendaten</b></th>
                                <th ng-if="isGeoresourceInfrastructureEnabled('aoi')" class="text-center"><b>Fl&auml;chendaten</b></th>
                                <th ng-if="isGeoresourceGeoserviceEnabled('wms')" class="text-center"><b>WMS-Daten</b></th>
                                <th ng-if="isGeoresourceGeoserviceEnabled('wfs')" class="text-center"><b>WFS-Daten</b></th>
							</tr>
							<tr>
								<td class="text-center" ng-if="isGeoresourceInfrastructureEnabled('poi')">
									<label class="switch">
										<input type="checkbox" ng-model="showPOI" checked
											ng-change="onChangeGeoresourceKeywordFilter(georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)">
										<span class="switchslider round"></span>
									</label>
								</td>
								<td class="text-center" ng-if="isGeoresourceInfrastructureEnabled('loi')">
									<label class="switch">
										<input type="checkbox" ng-model="showLOI" checked
											ng-change="onChangeGeoresourceKeywordFilter(georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)">
										<span class="switchslider round"></span>
									</label>
								</td>
								<td class="text-center" ng-if="isGeoresourceInfrastructureEnabled('aoi')">
									<label class="switch">
										<input type="checkbox" ng-model="showAOI" checked
											ng-change="onChangeGeoresourceKeywordFilter(georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)">
										<span class="switchslider round"></span>
									</label>
								</td>
								<td class="text-center" ng-if="isGeoresourceGeoserviceEnabled('wms')">
									<label class="switch">
										<input type="checkbox" ng-model="showWMS" checked
											ng-change="onChangeGeoresourceKeywordFilter(georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)">
										<span class="switchslider round"></span>
									</label>
								</td>
								<td class="text-center" ng-if="isGeoresourceGeoserviceEnabled('wfs')">
									<label class="switch">
										<input type="checkbox" ng-model="showWFS" checked
											ng-change="onChangeGeoresourceKeywordFilter(georesourceNameFilter.value, showPOI, showLOI, showAOI, showWMS, showWFS)">
										<span class="switchslider round"></span>
									</label>
								</td>
							</tr>
						</table>
						<!-- </div> -->



						<div id="georesourceHierarchySelection" class="list-group list-group-root well">

							<div
								ng-repeat="mainTopic in $ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy" ng-if="::mainTopic.totalCount">
								<div class="list-group-item list-group-item-default"
									style="background: #2171b5; color: white;">
									<a id="{{::mainTopic.topicId}}" href=""
										ng-attr-title="{{::mainTopic.topicDescription}}" class="collapseTrigger"
										style="color: white;" ng-click="isCollapsed_mainTopic = !isCollapsed_mainTopic"
										ng-init="isCollapsed_mainTopic=true"><i
											class="glyphicon glyphicon-chevron-right"></i>{{::mainTopic.topicName}}
										({{mainTopic.totalCount}})</a></a>
									&nbsp;&nbsp; <input type="checkbox" ng-model="mainTopic.isSelected"
										value="mainTopic.isSelected" id="showAllForTopic_{{::mainTopic.topicId}}"
										ng-change="handleShowAllOnTopic(mainTopic)">
								</div>

								<div class="list-group collapse"
								uib-collapse="isCollapsed_mainTopic">
								<div ng-repeat="subTopic in ::mainTopic.subTopics" ng-if="::subTopic.totalCount">

									<div class="list-group-item list-group-item-default"
										style="background: #6baed6; color: white;">
										<a id="{{::subTopic.topicId}}" class="collapseTrigger" style="color: white;"
											ng-attr-title="{{::subTopic.topicDescription}}" href=""
											ng-click="isCollapsed_subTopic = !isCollapsed_subTopic"
											ng-init="isCollapsed_subTopic=true"><i
												class="glyphicon glyphicon-chevron-right"></i>{{::subTopic.topicName}}
											({{subTopic.totalCount}})</a>
										&nbsp;&nbsp; <input type="checkbox" ng-model="subTopic.isSelected"
											value="subTopic.isSelected" id="showAllForTopic_{{::subTopic.topicId}}"
											ng-change="handleShowAllOnTopic(subTopic)">
									</div>

									<div class="list-group collapse"
									uib-collapse="isCollapsed_subTopic">
									<div ng-repeat="subsubTopic in ::subTopic.subTopics" ng-if="::subsubTopic.totalCount">

										<div class="list-group-item list-group-item-default"
											style="background: #bdd7e7; color: white;">
											<a id="{{::subsubTopic.topicId}}" class="collapseTrigger"
												style="color: black;" ng-attr-title="{{::subsubTopic.topicDescription}}"
												href="" ng-click="isCollapsed_subsubTopic = !isCollapsed_subsubTopic"
												ng-init="isCollapsed_subsubTopic=true"><i
													class="glyphicon glyphicon-chevron-right"></i>{{::subsubTopic.topicName}}
												({{subsubTopic.totalCount}})</a>
											&nbsp;&nbsp; <input type="checkbox" ng-model="subsubTopic.isSelected"
												value="subsubTopic.isSelected"
												id="showAllForTopic_{{::subsubTopic.topicId}}"
												ng-change="handleShowAllOnTopic(subsubTopic)">
										</div>

										<div class="list-group collapse" uib-collapse="isCollapsed_subsubTopic">
											<div ng-repeat="subsubsubTopic in ::subsubTopic.subTopics" ng-if="::subsubsubTopic.totalCount">

											<div class="list-group-item list-group-item-default"
												style="background: #eff3ff; color: white;">
												<a id="{{::subsubsubTopic.topicId}}" class="collapseTrigger"
													style="color: black;"
													ng-attr-title="{{::subsubsubTopic.topicDescription}}"
													ng-click="isCollapsed_subsubsubTopic = !isCollapsed_subsubsubTopic"
													ng-init="isCollapsed_subsubsubTopic=true"><i
													class="glyphicon glyphicon-chevron-right"></i>{{::subsubsubTopic.topicName}}
													({{subsubsubTopic.totalCount}})</a>
												&nbsp;&nbsp; <input type="checkbox" ng-model="subsubsubTopic.isSelected"
													value="subsubsubTopic.isSelected"
													id="showAllForTopic_{{::subsubsubTopic.topicId}}"
													ng-change="handleShowAllOnTopic(subsubsubTopic)">
											</div>

											<div class="list-group collapse" uib-collapse="isCollapsed_subsubsubTopic">
												<div ng-if="subsubsubTopic.ownCount > 0"
													class="list-group-item list-group-item-default georesourceInputForm">

													<table class="table table-condensed " style="margin-bottom:0px;">
														<thead>
															<tr>
																<th>Typ</th>
																<th>Datensatz</th>
																<th>Beschreibung</th>
																<th>Legende</th>
																<th
																	ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																	Lebenszeit-Beginn</th>
																<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
															</tr>
														</thead>

														<tbody>

															<!-- POIs -->
															<tr ng-repeat='poi in ::subsubsubTopic.poiData '>
																<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																<td>
																	<i class="fas fa-map-marker-alt"></i>
																</td>
																<td>
																	<label class='checkbox-inline'><input
																			type="checkbox" value="poi.datasetName"
																			ng-model="poi.isSelected"
																			ng-change="handlePoiOnMap(poi)">

																		<b>&nbsp;&nbsp;{{::poi.datasetName}}</b> <a href="" ng-show="poi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(poi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
																	</label>
																</td>
																<td>
																	<p>{{::poi.metadata.description}}</p>
																</td>
																<td class="text-center">
																	<div align="center">
																		<div
																			class="awesome-marker-legend awesome-marker-legend-icon-{{::poi.poiMarkerColor}}">
																			<span
																				ng-if="!poi.poiMarkerStyle || poi.poiMarkerStyle == 'symbol'"
																				style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::poi.poiSymbolColor}};"
																				class="glyphicon glyphicon-{{::poi.poiSymbolBootstrap3Name}}"
																				aria-hidden="true"></span>
																			<span 
																				ng-else
																				style="font-size:0.9em; color:{{::poi.poiSymbolColor}};">
																				{{ poi.poiMarkerText }}
																			</span>
																		</div>
																	</div>
																</td>
																<td
																	ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																	<select
																		style="font-size: 11px; width:135px; padding: 0px;"
																		ng-model="poi.selectedDate"
																		ng-change="onChangeSelectedDate(poi)"
																		ng-options="date as date.startDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																		ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
																		class="form-control" required>
																	</select>
																</td>
																<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																	<a href="" ng-click="getExportLinkForPoi(poi)"
																		title="Download Features as GeoJSON"><i
																			class="fas fa-file-download fa-lg"></i></a>
																			
																	<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(loi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
																	<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
																</td>
															</tr>

															<!-- LOIs -->
															<tr ng-repeat='loi in ::subsubsubTopic.loiData'>
																<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																<td>
																	<i class="fas fa-minus"></i>
																</td>
																<td>
																	<label class='checkbox-inline'><input
																			type="checkbox" value="loi.datasetName"
																			ng-model="loi.isSelected"
																			ng-change="handleLoiOnMap(loi)">

																		<b>&nbsp;&nbsp;{{::loi.datasetName}}</b> <a href="" ng-show="loi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(loi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
																	</label>
																</td>
																<td>
																	<p>{{::loi.metadata.description}}</p>
																</td>
																<td class="text-center">
																	<div align="center">
																		<i
																			style="width:15px; height:15px; background:{{::loi.loiColor}}; display:inherit;">
																		</i>
																	</div>

																</td>
																<td
																	ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																	<select
																		style="font-size: 11px; width:135px; padding: 0px;"
																		ng-model="loi.selectedDate"
																		ng-change="onChangeSelectedDate(loi)"
																		ng-options="date as date.startDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																		ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
																		class="form-control" required>
																	</select>
																</td>
																<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																	<a href="" ng-click="getExportLinkForLoi(loi)"
																		title="Download Features as GeoJSON"><i
																			class="fas fa-file-download fa-lg"></i></a>

																	<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(loi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
																	<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
																</td>
															</tr>

															<!-- AOIs -->
															<tr ng-repeat='aoi in ::subsubsubTopic.aoiData'>
																<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
																<td>
																	<i class="far fa-square"></i>
																</td>
																<td>
																	<label class='checkbox-inline'><input
																			type="checkbox" value="aoi.datasetName"
																			ng-model="aoi.isSelected"
																			ng-change="handleAoiOnMap(aoi)">

																		<b>&nbsp;&nbsp;{{::aoi.datasetName}}</b> <a href="" ng-show="aoi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(aoi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
																	</label>
																</td>
																<td>
																	<p>{{::aoi.metadata.description}}</p>
																</td>
																<td class="text-center">
																	<div align="center">
																		<i
																			style="width:15px; height:15px; background:{{::aoi.aoiColor}}; display:inherit;">
																		</i>
																	</div>
																</td>
																<td
																	ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																	<select
																		style="font-size: 11px; width:135px; padding: 0px;"
																		ng-model="aoi.selectedDate"
																		ng-change="onChangeSelectedDate(aoi)"
																		ng-options="date as date.startDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																		ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
																		class="form-control" required>
																	</select>
																</td>
																<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																	<a href="" ng-click="getExportLinkForAoi(aoi)"
																		title="Download Features as GeoJSON"><i
																			class="fas fa-file-download fa-lg"></i></a>

																	<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(aoi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
																	<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
																</td>
															</tr>

															<!-- WMS -->
															<tr ng-repeat='dataset in ::subsubsubTopic.wmsData'>
																<td>
																	<b><i>WMS</i></b>
																</td>
																<td>
																	<label class='checkbox-inline'><input
																			type="checkbox" value="dataset.title"
																			ng-model="dataset.isSelected"
																			ng-change="handleWmsOnMap(dataset)">

																		<b ng-bind-html="::dataset.title"></b>
																	</label>
																</td>
																<td>
																	<p ng-bind-html="::dataset.description"></p>
																</td>
																<td class="text-center">
																	<div ng-if="! dataset.showLegend">
																		<button class="btn btn-sm btn-primary"
																			ng-click="dataset.showLegend = true;">laden</button>
																	</div>
																	<div ng-if="dataset.showLegend">
																		<img
																			src="{{::dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{::dataset.layerName}}">
																	</div>
																</td>
																<td>
																	-
																</td>
																<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																	<div align="center">
																		<a href="{{::dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0"
																			title="WMS GetCapabilities URL"
																			rel='noopener noreferrer' target='_blank'><i
																				class="fas fa-cloud-download-alt"></i></a>
																	</div>
																</td>
															</tr>

															<!-- WFS -->
															<tr ng-repeat='dataset in ::subsubsubTopic.wfsData '>
																<td>
																	<b><i>WFS</i></b>
																</td>
																<td>
																	<label class='checkbox-inline'><input
																			type="checkbox" value="dataset.title"
																			ng-model="dataset.isSelected"
																			ng-change="handleWfsOnMap(dataset)">

																		<b ng-bind-html="::dataset.title"></b>
																	</label>
																</td>
																<td>
																	<p ng-bind-html="::dataset.description"></p>
																</td>
																<!-- <td>
																		<label class="switch">
																			<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																		  <span class="switchslider round"></span>
																		</label>
																	</td> -->

																<td class="text-center">
																	<div ng-show="::dataset.geometryType==='AOI'">
																		<div class="input-group colorpicker-component">
																			<input type="text" style="display:none;"
																				class="form-control input-sm"
																				ng-model="dataset.aoiColor"
																				ng-change="adjustWfsLayerColor(dataset)"
																				placeholder="WFS Darstellungsfarbe"
																				required />
																			<span
																				title="Klicken, um die Farbe anzupassen"
																				style="border: 1px solid #ccc;"
																				class="input-group-addon"><i></i></span>
																		</div>
																	</div>
																	<div ng-show="::dataset.geometryType==='LOI'">
																		<div class="input-group colorpicker-component">
																			<input type="text" style="display:none;"
																				class="form-control input-sm"
																				ng-model="dataset.loiColor"
																				ng-change="adjustWfsLayerColor(dataset)"
																				placeholder="WFS Darstellungsfarbe"
																				required />
																			<span
																				title="Klicken, um die Farbe anzupassen"
																				style="border: 1px solid #ccc;"
																				class="input-group-addon"><i></i></span>
																		</div>
																	</div>
																	<div ng-show="::dataset.geometryType==='POI'">
																		<div align="center">
																			<div
																				class="awesome-marker-legend awesome-marker-legend-icon-{{::dataset.poiMarkerColor}}">
																				<span
																					style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::dataset.poiSymbolColor}};"
																					class="glyphicon glyphicon-{{::dataset.poiSymbolBootstrap3Name}}"
																					aria-hidden="true"></span>
																			</div>
																		</div>
																	</div>
																</td>
																<td>
																	-
																</td>
																<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																	<div align="center">
																		<a href="{{::dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0"
																			title="WFS GetCapabilities URL"
																			rel='noopener noreferrer' target='_blank'><i
																				class="fas fa-cloud-download-alt"></i></a>
																	</div>
																</td>
															</tr>

														</tbody>

													</table>

												</div>
											</div>

										</div>
										<!-- end sub sub sub topics -->


										<div class="list-group" >
											<div class="list-group-item list-group-item-default georesourceInputForm"
											ng-if="subsubTopic.ownCount > 0">

												<table class="table table-condensed " style="margin-bottom:0px;">
													<thead>
														<tr>
															<th>Typ</th>
															<th>Datensatz</th>
															<th>Beschreibung</th>
															<th>Legende</th>
															<th
																ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																Lebenszeit-Beginn</th>
															<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
														</tr>
													</thead>

													<tbody>

														<!-- POIs -->
														<tr ng-repeat='poi in ::subsubTopic.poiData '>
															<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
															<td>
																<i class="fas fa-map-marker-alt"></i>
															</td>
															<td>
																<label class='checkbox-inline'><input type="checkbox"
																		value="poi.datasetName"
																		ng-model="poi.isSelected"
																		ng-change="handlePoiOnMap(poi)">

																	<b>&nbsp;&nbsp;{{::poi.datasetName}}</b> <a href="" ng-show="poi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(poi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
																</label>
															</td>
															<td>
																<p>{{::poi.metadata.description}}</p>
															</td>
															<td class="text-center">
																<div align="center">
																	<div
																		class="awesome-marker-legend awesome-marker-legend-icon-{{::poi.poiMarkerColor}}">
																		<span
																			ng-if="!poi.poiMarkerStyle || poi.poiMarkerStyle == 'symbol'"
																			style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::poi.poiSymbolColor}};"
																			class="glyphicon glyphicon-{{::poi.poiSymbolBootstrap3Name}}"
																			aria-hidden="true"></span>
																		<span 
																			ng-else
																			style="font-size:0.9em; color:{{::poi.poiSymbolColor}};">
																			{{ poi.poiMarkerText }}
																		</span>
																	</div>
																</div>
															</td>
															<td
																ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																<select
																	style="font-size: 11px; width:135px; padding: 0px;"
																	ng-model="poi.selectedDate"
																	ng-change="onChangeSelectedDate(poi)"
																	ng-options="date as date.startDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																	ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
																	class="form-control" required>
																</select>
															</td>
															<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																<a href="" ng-click="getExportLinkForPoi(poi)"
																	title="Download Features as GeoJSON"><i
																		class="fas fa-file-download fa-lg"></i></a>

																<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(poi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
																<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
															</td>
														</tr>

														<!-- LOIs -->
														<tr ng-repeat='loi in ::subsubTopic.loiData'>
															<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
															<td>
																<i class="fas fa-minus"></i>
															</td>
															<td>
																<label class='checkbox-inline'><input type="checkbox"
																		value="loi.datasetName"
																		ng-model="loi.isSelected"
																		ng-change="handleLoiOnMap(loi)">

																	<b>&nbsp;&nbsp;{{::loi.datasetName}}</b> <a href="" ng-show="loi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(loi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
																</label>
															</td>
															<td>
																<p>{{::loi.metadata.description}}</p>
															</td>
															<td class="text-center">
																<div align="center">
																	<i
																		style="width:15px; height:15px; background:{{::loi.loiColor}}; display:inherit;">
																	</i>
																</div>

															</td>
															<td
																ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																<select
																	style="font-size: 11px; width:135px; padding: 0px;"
																	ng-model="loi.selectedDate"
																	ng-change="onChangeSelectedDate(loi)"
																	ng-options="date as date.startDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																	ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
																	class="form-control" required>
																</select>
															</td>
															<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																<a href="" ng-click="getExportLinkForLoi(loi)"
																	title="Download Features as GeoJSON"><i
																		class="fas fa-file-download fa-lg"></i></a>

																<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(loi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
																<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
															</td>
														</tr>

														<!-- AOIs -->
														<tr ng-repeat='aoi in ::subsubTopic.aoiData'>
															<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
															<td>
																<i class="far fa-square"></i>
															</td>
															<td>
																<label class='checkbox-inline'><input type="checkbox"
																		value="aoi.datasetName"
																		ng-model="aoi.isSelected"
																		ng-change="handleAoiOnMap(aoi)">

																	<b>&nbsp;&nbsp;{{::aoi.datasetName}}</b> <a href="" ng-show="aoi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(aoi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
																</label>
															</td>
															<td>
																<p>{{::aoi.metadata.description}}</p>
															</td>
															<td class="text-center">
																<div align="center">
																	<i
																		style="width:15px; height:15px; background:{{::aoi.aoiColor}}; display:inherit;">
																	</i>
																</div>
															</td>
															<td
																ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
																<select
																	style="font-size: 11px; width:135px; padding: 0px;"
																	ng-model="aoi.selectedDate"
																	ng-change="onChangeSelectedDate(aoi)"
																	ng-options="date as date.startDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																	ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
																	class="form-control" required>
																</select>
															</td>
															<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																<a href="" ng-click="getExportLinkForAoi(aoi)"
																	title="Download Features as GeoJSON"><i
																		class="fas fa-file-download fa-lg"></i></a>

																<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(aoi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
																<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
															</td>
														</tr>

														<!-- WMS -->
														<tr ng-repeat='dataset in ::subsubTopic.wmsData'>
															<td>
																<b><i>WMS</i></b>
															</td>
															<td>
																<label class='checkbox-inline'><input type="checkbox"
																		value="dataset.title"
																		ng-model="dataset.isSelected"
																		ng-change="handleWmsOnMap(dataset)">

																	<b ng-bind-html="::dataset.title"></b>
																</label>
															</td>
															<td>
																<p ng-bind-html="::dataset.description"></p>
															</td>
															<td class="text-center">
																<div ng-if="! dataset.showLegend">
																	<button class="btn btn-sm btn-primary"
																		ng-click="dataset.showLegend = true;">laden</button>
																</div>
																<div ng-if="dataset.showLegend">
																	<img
																		src="{{::dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{::dataset.layerName}}">
																</div>
															</td>
															<td>
																-
															</td>
															<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																<div align="center">
																	<a href="{{::dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0"
																		title="WMS GetCapabilities URL"
																		rel='noopener noreferrer' target='_blank'><i
																			class="fas fa-cloud-download-alt"></i></a>
																</div>
															</td>
														</tr>

														<!-- WFS -->
														<tr ng-repeat='dataset in ::subsubTopic.wfsData '>
															<td>
																<b><i>WFS</i></b>
															</td>
															<td>
																<label class='checkbox-inline'><input type="checkbox"
																		value="dataset.title"
																		ng-model="dataset.isSelected"
																		ng-change="handleWfsOnMap(dataset)">

																	<b ng-bind-html="::dataset.title"></b>
																</label>
															</td>
															<td>
																<p ng-bind-html="::dataset.description"></p>
															</td>
															<!-- <td>
																		<label class="switch">
																			<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																		  <span class="switchslider round"></span>
																		</label>
																	</td> -->

															<td class="text-center">
																<div ng-show="::dataset.geometryType==='AOI'">
																	<div class="input-group colorpicker-component">
																		<input type="text" style="display:none;"
																			class="form-control input-sm"
																			ng-model="dataset.aoiColor"
																			ng-change="adjustWfsLayerColor(dataset)"
																			placeholder="WFS Darstellungsfarbe"
																			required />
																		<span title="Klicken, um die Farbe anzupassen"
																			style="border: 1px solid #ccc;"
																			class="input-group-addon"><i></i></span>
																	</div>
																</div>
																<div ng-show="::dataset.geometryType==='LOI'">
																	<div class="input-group colorpicker-component">
																		<input type="text" style="display:none;"
																			class="form-control input-sm"
																			ng-model="dataset.loiColor"
																			ng-change="adjustWfsLayerColor(dataset)"
																			placeholder="WFS Darstellungsfarbe"
																			required />
																		<span title="Klicken, um die Farbe anzupassen"
																			style="border: 1px solid #ccc;"
																			class="input-group-addon"><i></i></span>
																	</div>
																</div>
																<div ng-show="::dataset.geometryType==='POI'">
																	<div align="center">
																		<div
																			class="awesome-marker-legend awesome-marker-legend-icon-{{::dataset.poiMarkerColor}}">
																			<span
																				style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::dataset.poiSymbolColor}};"
																				class="glyphicon glyphicon-{{::dataset.poiSymbolBootstrap3Name}}"
																				aria-hidden="true"></span>
																		</div>
																	</div>
																</div>
															</td>
															<td>
																-
															</td>
															<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
																<div align="center">
																	<a href="{{::dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0"
																		title="WFS GetCapabilities URL"
																		rel='noopener noreferrer' target='_blank'><i
																			class="fas fa-cloud-download-alt"></i></a>
																</div>
															</td>
														</tr>

													</tbody>

												</table>

											</div>
										</div>
										</div>

									</div>
									<!-- end sub sub opics -->



									<div class="list-group" >
										<div class="list-group-item list-group-item-default georesourceInputForm"
										ng-if="subTopic.ownCount > 0">

											<table class="table table-condensed " style="margin-bottom:0px;">
												<thead>
													<tr>
														<th>Typ</th>
														<th>Datensatz</th>
														<th>Beschreibung</th>
														<th>Legende</th>
														<th
															ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
															Lebenszeit-Beginn</th>
														<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
													</tr>
												</thead>

												<tbody>

													<!-- POIs -->
													<tr ng-repeat='poi in ::subTopic.poiData '>
														<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
														<td>
															<i class="fas fa-map-marker-alt"></i>
														</td>
														<td>
															<label class='checkbox-inline'><input type="checkbox"
																	value="poi.datasetName" ng-model="poi.isSelected"
																	ng-change="handlePoiOnMap(poi)">

																<b>&nbsp;&nbsp;{{::poi.datasetName}}</b> <a href="" ng-show="poi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(poi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
															</label>
														</td>
														<td>
															<p>{{::poi.metadata.description}}</p>
														</td>
														<td class="text-center">
															<div align="center">
																<div
																	class="awesome-marker-legend awesome-marker-legend-icon-{{::poi.poiMarkerColor}}">
																	<span
																		ng-if="!poi.poiMarkerStyle || poi.poiMarkerStyle == 'symbol'"
																		style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::poi.poiSymbolColor}};"
																		class="glyphicon glyphicon-{{::poi.poiSymbolBootstrap3Name}}"
																		aria-hidden="true"></span>
																	<span 
																		ng-else
																		style="font-size:0.9em; color:{{::poi.poiSymbolColor}};">
																		{{ poi.poiMarkerText }}
																	</span>
																</div>
															</div>
														</td>
														<td
															ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
															<select style="font-size: 11px; width:135px; padding: 0px;"
																ng-model="poi.selectedDate"
																ng-change="onChangeSelectedDate(poi)"
																ng-options="date as date.startDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
																class="form-control" required>
															</select>
														</td>
														<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
															<a href="" ng-click="getExportLinkForPoi(poi)"
																title="Download Features as GeoJSON"><i
																	class="fas fa-file-download fa-lg"></i></a>

															<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(poi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
															<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
														</td>
													</tr>

													<!-- LOIs -->
													<tr ng-repeat='loi in ::subTopic.loiData'>
														<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
														<td>
															<i class="fas fa-minus"></i>
														</td>
														<td>
															<label class='checkbox-inline'><input type="checkbox"
																	value="loi.datasetName" ng-model="loi.isSelected"
																	ng-change="handleLoiOnMap(loi)">

																<b>&nbsp;&nbsp;{{::loi.datasetName}}</b> <a href="" ng-show="loi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(loi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
															</label>
														</td>
														<td>
															<p>{{::loi.metadata.description}}</p>
														</td>
														<td class="text-center">
															<div align="center">
																<i
																	style="width:15px; height:15px; background:{{::loi.loiColor}}; display:inherit;">
																</i>
															</div>
														</td>
														<td
															ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
															<select style="font-size: 11px; width:135px; padding: 0px;"
																ng-model="loi.selectedDate"
																ng-change="onChangeSelectedDate(loi)"
																ng-options="date as date.startDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
																class="form-control" required>
															</select>
														</td>
														<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
															<a href="" ng-click="getExportLinkForLoi(loi)"
																title="Download Features as GeoJSON"><i
																	class="fas fa-file-download fa-lg"></i></a>

															<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(loi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
															<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
														</td>
													</tr>

													<!-- AOIs -->
													<tr ng-repeat='aoi in ::subTopic.aoiData '>
														<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
														<td>
															<i class="far fa-square"></i>
														</td>
														<td>
															<label class='checkbox-inline'><input type="checkbox"
																	value="aoi.datasetName" ng-model="aoi.isSelected"
																	ng-change="handleAoiOnMap(aoi)">

																<b>&nbsp;&nbsp;{{::aoi.datasetName}}</b> <a href="" ng-show="aoi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(aoi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
															</label>
														</td>
														<td>
															<p>{{::aoi.metadata.description}}</p>
														</td>
														<td class="text-center">
															<div align="center">
																<i
																	style="width:15px; height:15px; background:{{::aoi.aoiColor}}; display:inherit;">
																</i>
															</div>
														</td>
														<td>
															<select style="font-size: 11px; width:135px; padding: 0px;"
																ng-model="aoi.selectedDate"
																ng-change="onChangeSelectedDate(aoi)"
																ng-options="date as date.startDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
																ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
																class="form-control" required>
															</select>
														</td>
														<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
															<a href="" ng-click="getExportLinkForAoi(aoi)"
																title="Download Features as GeoJSON"><i
																	class="fas fa-file-download fa-lg"></i></a>

															<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(aoi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
															<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
														</td>
													</tr>

													<!-- WMS -->
													<tr ng-repeat='dataset in ::subTopic.wmsData'>
														<td>
															<b><i>WMS</i></b>
														</td>
														<td>
															<label class='checkbox-inline'><input type="checkbox"
																	value="dataset.title" ng-model="dataset.isSelected"
																	ng-change="handleWmsOnMap(dataset)">

																<b ng-bind-html="::dataset.title"></b>
															</label>
														</td>
														<td>
															<p ng-bind-html="::dataset.description"></p>
														</td>

														<td class="text-center">
															<div ng-if="! dataset.showLegend">
																<button class="btn btn-sm btn-primary"
																	ng-click="dataset.showLegend = true;">laden</button>
															</div>
															<div ng-if="dataset.showLegend">
																<img
																	src="{{::dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{::dataset.layerName}}">
															</div>
														</td>
														<td>
															-
														</td>
														<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
															<div align="center">
																<a href="{{::dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0"
																	title="WMS GetCapabilities URL"
																	rel='noopener noreferrer' target='_blank'><i
																		class="fas fa-cloud-download-alt"></i></a>
															</div>
														</td>
													</tr>

													<!-- WFS -->
													<tr ng-repeat='dataset in ::subTopic.wfsData'>
														<td>
															<b><i>WFS</i></b>
														</td>
														<td>
															<label class='checkbox-inline'><input type="checkbox"
																	value="dataset.title" ng-model="dataset.isSelected"
																	ng-change="handleWfsOnMap(dataset)">

																<b ng-bind-html="::dataset.title"></b>
															</label>
														</td>
														<td>
															<p ng-bind-html="::dataset.description"></p>
														</td>
														<!-- <td>
																	<label class="switch">
																		<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																	  <span class="switchslider round"></span>
																	</label>
																</td> -->

														<td class="text-center">
															<div>
																<div ng-show="::dataset.geometryType==='AOI'">
																	<div class="input-group colorpicker-component">
																		<input type="text" style="display:none;"
																			class="form-control input-sm"
																			ng-model="dataset.aoiColor"
																			ng-change="adjustWfsLayerColor(dataset)"
																			placeholder="WFS Darstellungsfarbe"
																			required />
																		<span title="Klicken, um die Farbe anzupassen"
																			style="border: 1px solid #ccc;"
																			class="input-group-addon"><i></i></span>
																	</div>
																</div>
																<div ng-show="::dataset.geometryType==='LOI'">
																	<div class="input-group colorpicker-component">
																		<input type="text" style="display:none;"
																			class="form-control input-sm"
																			ng-model="dataset.loiColor"
																			ng-change="adjustWfsLayerColor(dataset)"
																			placeholder="WFS Darstellungsfarbe"
																			required />
																		<span title="Klicken, um die Farbe anzupassen"
																			style="border: 1px solid #ccc;"
																			class="input-group-addon"><i></i></span>
																	</div>
																</div>
																<div ng-show="::dataset.geometryType==='POI'">
																	<div align="center">
																		<div
																			class="awesome-marker-legend awesome-marker-legend-icon-{{::dataset.poiMarkerColor}}">
																			<span
																				style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::dataset.poiSymbolColor}};"
																				class="glyphicon glyphicon-{{::dataset.poiSymbolBootstrap3Name}}"
																				aria-hidden="true"></span>
																		</div>
																	</div>
																</div>
															</div>
														</td>
														<td>
															-
														</td>
														<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
															<div align="center">
																<a href="{{::dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0"
																	title="WFS GetCapabilities URL"
																	rel='noopener noreferrer' target='_blank'><i
																		class="fas fa-cloud-download-alt"></i></a>
															</div>
														</td>
													</tr>

												</tbody>

											</table>

										</div>
									</div>
									</div>




								</div>
								<!-- end sub topics -->
								<div class="list-group" >
									<div class="list-group-item list-group-item-default georesourceInputForm"
									ng-if="mainTopic.ownCount > 0">

										<table class="table table-condensed " style="margin-bottom:0px;">
											<thead>
												<tr>
													<th>Typ</th>
													<th>Datensatz</th>
													<th>Beschreibung</th>
													<th>Legende</th>
													<th
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														Lebenszeit-Beginn</th>
													<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
												</tr>
											</thead>

											<tbody>

												<!-- POIs -->
												<tr ng-repeat='poi in ::mainTopic.poiData'>
													<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
													<td>
														<i class="fas fa-map-marker-alt"></i>
													</td>
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="poi.datasetName" ng-model="poi.isSelected"
																ng-change="handlePoiOnMap(poi)">

															<b>&nbsp;&nbsp;{{::poi.datasetName}}</b> <a href="" ng-show="poi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(poi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
														</label>
													</td>
													<td>
														<p>{{::poi.metadata.description}}</p>
													</td>
													<td class="text-center">
														<div align="center">
															<div
																class="awesome-marker-legend awesome-marker-legend-icon-{{::poi.poiMarkerColor}}">
																<span
																	ng-if="!poi.poiMarkerStyle || poi.poiMarkerStyle == 'symbol'"
																	style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::poi.poiSymbolColor}};"
																	class="glyphicon glyphicon-{{::poi.poiSymbolBootstrap3Name}}"
																	aria-hidden="true"></span>
																<span 
																	ng-else
																	style="font-size:0.9em; color:{{::poi.poiSymbolColor}};">
																	{{ poi.poiMarkerText }}
																</span>
															</div>
														</div>
													</td>
													<td
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														<select style="font-size: 11px; width:135px; padding: 0px;"
															ng-model="poi.selectedDate"
															ng-change="onChangeSelectedDate(poi)"
															ng-options="date as date.startDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
															ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
															class="form-control" required>
														</select>
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<a href="" ng-click="getExportLinkForPoi(poi)"
															title="Download Features as GeoJSON"><i
																class="fas fa-file-download fa-lg"></i></a>

														<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(poi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
														<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
													</td>
												</tr>

												<!-- LOIs -->
												<tr ng-repeat='loi in ::mainTopic.loiData '>
													<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
													<td>
														<i class="fas fa-minus"></i>
													</td>
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="loi.datasetName" ng-model="loi.isSelected"
																ng-change="handleLoiOnMap(loi)">

															<b>&nbsp;&nbsp;{{::loi.datasetName}}</b> <a href="" ng-show="loi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(loi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
														</label>
													</td>
													<td>
														<p>{{::loi.metadata.description}}</p>
													</td>
													<td class="text-center">
														<div align="center">
															<i
																style="width:15px; height:15px; background:{{::loi.loiColor}}; display:inherit;">
															</i>
														</div>
													</td>
													<td
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														<select style="font-size: 11px; width:135px; padding: 0px;"
															ng-model="loi.selectedDate"
															ng-change="onChangeSelectedDate(loi)"
															ng-options="date as date.startDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
															ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
															class="form-control" required>
														</select>
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<a href="" ng-click="getExportLinkForLoi(loi)"
															title="Download Features as GeoJSON"><i
																class="fas fa-file-download fa-lg"></i></a>

														<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(loi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
														<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
													</td>
												</tr>

												<!-- AOIs -->
												<tr ng-repeat='aoi in ::mainTopic.aoiData'>
													<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
													<td>
														<i class="far fa-square"></i>
													</td>
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="aoi.datasetName" ng-model="aoi.isSelected"
																ng-change="handleAoiOnMap(aoi)">

															<b>&nbsp;&nbsp;{{::aoi.datasetName}}</b> <a href="" ng-show="aoi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(aoi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
														</label>
													</td>
													<td>
														<p>{{::aoi.metadata.description}}</p>
													</td>
													<td class="text-center">
														<div align="center">
															<i
																style="width:15px; height:15px; background:{{::aoi.aoiColor}}; display:inherit;">
															</i>
														</div>
													</td>
													<td
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														<select style="font-size: 11px; width:135px; padding: 0px;"
															ng-model="aoi.selectedDate"
															ng-change="onChangeSelectedDate(aoi)"
															ng-options="date as date.startDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
															ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
															class="form-control" required>
														</select>
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<a href="" ng-click="getExportLinkForAoi(aoi)"
															title="Download Features as GeoJSON"><i
																class="fas fa-file-download fa-lg"></i></a>

														<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(aoi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
														<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
													</td>
												</tr>

												<!-- WMS -->
												<tr ng-repeat='dataset in ::mainTopic.wmsData'>
													<td>
														<b><i>WMS</i></b>
													</td>
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="dataset.title" ng-model="dataset.isSelected"
																ng-change="handleWmsOnMap(dataset)">

															<b ng-bind-html="::dataset.title"></b>
														</label>
													</td>
													<td>
														<p ng-bind-html="::dataset.description"></p>
													</td>

													<td class="text-center">
														<div ng-if="! dataset.showLegend">
															<button class="btn btn-sm btn-primary"
																ng-click="dataset.showLegend = true;">laden</button>
														</div>
														<div ng-if="dataset.showLegend">
															<img
																src="{{::dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{::dataset.layerName}}">
														</div>
													</td>
													<td>
														-
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<div align="center">
															<a href="{{::dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0"
																title="WMS GetCapabilities URL"
																rel='noopener noreferrer' target='_blank'><i
																	class="fas fa-cloud-download-alt"></i></a>
														</div>
													</td>
												</tr>

												<!-- WFS -->
												<tr ng-repeat='dataset in ::mainTopic.wfsData'>
													<td>
														<b><i>WFS</i></b>
													</td>
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="dataset.title" ng-model="dataset.isSelected"
																ng-change="handleWfsOnMap(dataset)">

															<b ng-bind-html="::dataset.title"></b>
														</label>
													</td>
													<td>
														<p ng-bind-html="::dataset.description"></p>
													</td>
													<!-- <td>
																<label class="switch">
																	<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
																  <span class="switchslider round"></span>
																</label>
															</td> -->

													<td class="text-center">
														<div>
															<div ng-show="dataset.geometryType==='AOI'">
																<div class="input-group colorpicker-component">
																	<input type="text" style="display:none;"
																		class="form-control input-sm"
																		ng-model="dataset.aoiColor"
																		ng-change="adjustWfsLayerColor(dataset)"
																		placeholder="WFS Darstellungsfarbe" required />
																	<span title="Klicken, um die Farbe anzupassen"
																		style="border: 1px solid #ccc;"
																		class="input-group-addon"><i></i></span>
																</div>
															</div>
															<div ng-show="dataset.geometryType==='LOI'">
																<div class="input-group colorpicker-component">
																	<input type="text" style="display:none;"
																		class="form-control input-sm"
																		ng-model="dataset.loiColor"
																		ng-change="adjustWfsLayerColor(dataset)"
																		placeholder="WFS Darstellungsfarbe" required />
																	<span title="Klicken, um die Farbe anzupassen"
																		style="border: 1px solid #ccc;"
																		class="input-group-addon"><i></i></span>
																</div>
															</div>
															<div ng-show="dataset.geometryType==='POI'">
																<div align="center">
																	<div
																		class="awesome-marker-legend awesome-marker-legend-icon-{{::dataset.poiMarkerColor}}">
																		<span
																			style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::dataset.poiSymbolColor}};"
																			class="glyphicon glyphicon-{{::dataset.poiSymbolBootstrap3Name}}"
																			aria-hidden="true"></span>
																	</div>
																</div>
															</div>
														</div>
													</td>
													<td>
														-
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<div align="center">
															<a href="{{::dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0"
																title="WFS GetCapabilities URL"
																rel='noopener noreferrer' target='_blank'><i
																	class="fas fa-cloud-download-alt"></i></a>
														</div>
													</td>
												</tr>

											</tbody>

										</table>

									</div>
								</div>
								</div>

								<!-- <div ng-repeat="georesourceMetadata in $ctrl.kommonitorDataExchangeServiceInstance.availableGeoresources  | filter:{topicReference:mainTopic.topicId} ">
									</div> -->
							</div>
							<!-- end main Topics -->

							<div class="list-group-item list-group-item-default"
								style="background: #2171b5; color: white;" ng-if="$ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.totalCount > 0">
								<a id="noHierarchyGeoresourceDatasets" href=""
									ng-attr-title="Georessourcen-Daten ohne Themenbezug" class="collapseTrigger"
									style="color: white;" 
									ng-init="isCollapsed_noTopic=true"
									ng-click="toggleNoTopicHierarchy()">
										<i	class="glyphicon glyphicon-chevron-right"></i>ohne Themenbezug
									({{$ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.totalCount}})</a>
								&nbsp;&nbsp; <input type="checkbox" value="showAllForTopic_null"
									ng-model="showAllForTopic_null" ng-change="handleShowAllOnTopic(null)">
							</div>


							<div class="list-group collapse" uib-collapse="isCollapsed_noTopic">

								<div class="georesourceInputForm"
									ng-if="$ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.totalCount > 0">
									
									<table class="table table-condensed" style="margin-bottom:0px;">
										<thead>
											<tr>
												<th>Typ</th>
												<th>Datensatz</th>
												<th>Beschreibung</th>
												<th>Legende</th>
												<th
													ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
													Lebenszeit-Beginn</th>
												<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
											</tr>
										</thead>

										<tbody>

											<!-- POIs -->
											<tr
												ng-repeat='poi in $ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.poiData'>
												<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
												<td>
													<i class="fas fa-map-marker-alt"></i>
												</td>
												<td>
													<label class='checkbox-inline'><input type="checkbox"
															value="poi.datasetName" ng-model="poi.isSelected"
															ng-change="handlePoiOnMap(poi)">

														<b>&nbsp;&nbsp;{{::poi.datasetName}}</b> <a href="" ng-show="poi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(poi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
													</label>
												</td>
												<td>
													<p>{{::poi.metadata.description}}</p>
												</td>
												<td class="text-center">
													<div align="center">
														<div
															class="awesome-marker-legend awesome-marker-legend-icon-{{::poi.poiMarkerColor}}">
															<span
																ng-if="!poi.poiMarkerStyle || poi.poiMarkerStyle == 'symbol'"
																style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::poi.poiSymbolColor}};"
																class="glyphicon glyphicon-{{::poi.poiSymbolBootstrap3Name}}"
																aria-hidden="true"></span>
															<span 
																ng-else
																style="font-size:0.9em; color:{{::poi.poiSymbolColor}};">
																{{ poi.poiMarkerText }}
															</span>
														</div>
													</div>
												</td>
												<td
													ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
													<select style="font-size: 11px; width:135px; padding: 0px;"
														ng-model="poi.selectedDate"
														ng-change="onChangeSelectedDate(poi)"
														ng-options="date as date.startDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
														ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
														class="form-control" required>
													</select>
												</td>
												<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
													<a href="" ng-click="getExportLinkForPoi(poi)"
														title="Download Features as GeoJSON"><i
															class="fas fa-file-download fa-lg"></i></a>

													<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(poi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
													<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
												</td>
											</tr>

											<!-- LOIs -->
											<tr
												ng-repeat='loi in $ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.loiData'>
												<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
												<td>
													<i class="fas fa-minus"></i>
												</td>
												<td>
													<label class='checkbox-inline'><input type="checkbox"
															value="loi.datasetName" ng-model="loi.isSelected"
															ng-change="handleLoiOnMap(loi)">

														<b>&nbsp;&nbsp;{{::loi.datasetName}}</b> <a href="" ng-show="loi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(loi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
													</label>
												</td>
												<td>
													<p>{{::loi.metadata.description}}</p>
												</td>>
												<td class="text-center">
													<div align="center">
														<i
															style="width:15px; height:15px; background:{{::loi.loiColor}}; display:inherit;">
														</i>
													</div>
												</td>
												<td
													ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
													<select style="font-size: 11px; width:135px; padding: 0px;"
														ng-model="loi.selectedDate"
														ng-change="onChangeSelectedDate(loi)"
														ng-options="date as date.startDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
														ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
														class="form-control" required>
													</select>
												</td>
												<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
													<a href="" ng-click="getExportLinkForLoi(loi)"
														title="Download Features as GeoJSON"><i
															class="fas fa-file-download fa-lg"></i></a>

													<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(loi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
													<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
												</td>
											</tr>

											<!-- AOIs -->
											<tr
												ng-repeat='aoi in $ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.aoiData'>
												<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
												<td>
													<i class="far fa-square"></i>
												</td>
												<td>
													<label class='checkbox-inline'><input type="checkbox"
															value="aoi.datasetName" ng-model="aoi.isSelected"
															ng-change="handleAoiOnMap(aoi)">

														<b>&nbsp;&nbsp;{{::aoi.datasetName}}</b> <a href="" ng-show="aoi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(aoi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
													</label>
												</td>
												<td>
													<p>{{::aoi.metadata.description}}</p>
												</td>
												<td class="text-center">
													<div align="center">
														<i
															style="width:15px; height:15px; background:{{::aoi.aoiColor}}; display:inherit;">
														</i>
													</div>
												</td>
												<td
													ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
													<select style="font-size: 11px; width:135px; padding: 0px;"
														ng-model="aoi.selectedDate"
														ng-change="onChangeSelectedDate(aoi)"
														ng-options="date as date.startDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
														ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
														class="form-control" required>
													</select>
												</td>
												<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
													<a href="" ng-click="getExportLinkForAoi(aoi)"
														title="Download Features as GeoJSON"><i
															class="fas fa-file-download fa-lg"></i></a>

													<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(aoi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
													<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
												</td>
											</tr>

											<!-- WMS -->
											<tr
												ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.wmsData'>
												<td>
													<b><i>WMS</i></b>
												</td>
												<td>
													<label class='checkbox-inline'><input type="checkbox"
															value="dataset.title" ng-model="dataset.isSelected"
															ng-change="handleWmsOnMap(dataset)">

														<b ng-bind-html="::dataset.title"></b>
													</label>
												</td>
												<td>
													<p ng-bind-html="::dataset.description"></p>
												</td>

												<td class="text-center">
													<div ng-if="! dataset.showLegend">
														<button class="btn btn-sm btn-primary"
															ng-click="dataset.showLegend = true;">laden</button>
													</div>
													<div ng-if="dataset.showLegend">
														<img
															src="{{::dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{::dataset.layerName}}">
													</div>
												</td>
												<td>
													-
												</td>
												<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
													<div align="center">
														<a href="{{::dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0"
															title="WMS GetCapabilities URL" rel='noopener noreferrer'
															target='_blank'><i
																class="fas fa-cloud-download-alt"></i></a>
													</div>
												</td>
											</tr>

											<!-- WFS -->
											<tr
												ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.topicGeoresourceHierarchy_unmappedEntries.wfsData'>
												<td>
													<b><i>WFS</i></b>
												</td>
												<td>
													<label class='checkbox-inline'><input type="checkbox"
															value="dataset.title" ng-model="dataset.isSelected"
															ng-change="handleWfsOnMap(dataset)">

														<b ng-bind-html="::dataset.title"></b>
													</label>
												</td>
												<td>
													<p ng-bind-html="::dataset.description"></p>
												</td>
												<!-- <td>
												<label class="switch">
													<input id="filterCheckbox" type="checkbox" ng-model="dataset.filterFeaturesToMapBBOX" ng-checked="dataset.filterFeaturesToMapBBOX"></input>
												  <span class="switchslider round"></span>
												</label>
											</td> -->

												<td class="text-center">
													<div>
														<div ng-show="dataset.geometryType==='AOI'">
															<div class="input-group colorpicker-component">
																<input type="text" style="display:none;"
																	class="form-control input-sm"
																	ng-model="dataset.aoiColor"
																	ng-change="adjustWfsLayerColor(dataset)"
																	placeholder="WFS Darstellungsfarbe" required />
																<span title="Klicken, um die Farbe anzupassen"
																	style="border: 1px solid #ccc;"
																	class="input-group-addon"><i></i></span>
															</div>
														</div>
														<div ng-show="dataset.geometryType==='LOI'">
															<div class="input-group colorpicker-component">
																<input type="text" style="display:none;"
																	class="form-control input-sm"
																	ng-model="dataset.loiColor"
																	ng-change="adjustWfsLayerColor(dataset)"
																	placeholder="WFS Darstellungsfarbe" required />
																<span title="Klicken, um die Farbe anzupassen"
																	style="border: 1px solid #ccc;"
																	class="input-group-addon"><i></i></span>
															</div>
														</div>
														<div ng-show="dataset.geometryType==='POI'">
															<div align="center">
																<div
																	class="awesome-marker-legend awesome-marker-legend-icon-{{::dataset.poiMarkerColor}}">
																	<span
																		style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::dataset.poiSymbolColor}};"
																		class="glyphicon glyphicon-{{::dataset.poiSymbolBootstrap3Name}}"
																		aria-hidden="true"></span>
																</div>
															</div>
														</div>
													</div>
												</td>
												<td>
													-
												</td>
												<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
													<div align="center">
														<a href="{{::dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0"
															title="WFS GetCapabilities URL" rel='noopener noreferrer'
															target='_blank'><i
																class="fas fa-cloud-download-alt"></i></a>
													</div>
												</td>
											</tr>

										</tbody>

									</table>

								</div>
							</div>


						</div>


					</div>

				</uib-tab>
				<uib-tab index="1" heading="Alphabetische Listen">
					<div class="just-padding">

						<!-- POINTS OF INTEREST -->
						<div class="box box-primary collapsed-box" ng-if="isGeoresourceInfrastructureEnabled('poi')">
							<div class="box-header with-border">
								<h3 class="box-title">Points of Interest</h3>

								<div class="box-tools pull-right">
									<button type="button" class="btn btn-box-tool" data-widget="collapse"><i
											class="fa fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">

								<div class="">

									<div id="poiInputForm">

										<table class="table table-condensed" style="margin-bottom:0px;">
											<thead>
												<tr>
													<th>Datensatz</th>
													<th>Beschreibung</th>
													<th>Legende</th>
													<th
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														Lebenszeit-Beginn</th>
													<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
												</tr>
											</thead>

											<tbody>

												<tr
													ng-repeat='poi in $ctrl.kommonitorDataExchangeServiceInstance.displayableGeoresources_keywordFiltered_forAlphabeticalDisplay.poiData'>
													<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="poi.datasetName" ng-model="poi.isSelected"
																ng-change="handlePoiOnMap(poi)">

															<b>&nbsp;&nbsp;{{::poi.datasetName}}</b> <a href="" ng-show="poi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(poi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
														</label>
													</td>
													<td>
														<p>{{::poi.metadata.description}}</p>
													</td>
													<td class="text-center">
														<div align="center">
															<div
																class="awesome-marker-legend awesome-marker-legend-icon-{{::poi.poiMarkerColor}}">
																<span
																	ng-if="!poi.poiMarkerStyle || poi.poiMarkerStyle == 'symbol'"
																	style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::poi.poiSymbolColor}};"
																	class="glyphicon glyphicon-{{::poi.poiSymbolBootstrap3Name}}"
																	aria-hidden="true"></span>
																<span 
																	ng-else
																	style="font-size:0.9em; color:{{::poi.poiSymbolColor}};">
																	{{ poi.poiMarkerText }}
																</span>
															</div>
														</div>
													</td>
													<td
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														<select style="font-size: 11px; width:135px; padding: 0px;"
															ng-model="poi.selectedDate"
															ng-change="onChangeSelectedDate(poi)"
															ng-options="date as date.startDate for date in poi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
															ng-init="poi.selectedDate = poi.availablePeriodsOfValidity[poi.availablePeriodsOfValidity.length - 1]"
															class="form-control" required>
														</select>
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<a href="" ng-click="getExportLinkForPoi(poi)"
															title="Download Features as GeoJSON"><i
																class="fas fa-file-download fa-lg"></i></a>

														<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(poi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
														<!-- <a ng-href="getExportLinkForPoi(poi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
													</td>
												</tr>
											</tbody>
										</table>
									</div>

									<br />



								</div>

							</div>
							<!-- /.box-body -->

						</div>
						<!-- /.box -->


						<!-- LINES OF INTEREST -->
						<div class="box box-primary collapsed-box" ng-if="isGeoresourceInfrastructureEnabled('loi')">
							<div class="box-header with-border">
								<h3 class="box-title">Lines of Interest</h3>

								<div class="box-tools pull-right">
									<button type="button" class="btn btn-box-tool" data-widget="collapse"><i
											class="fa fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">

								<div class="">

									<div id="loiInputForm">

										<table class="table table-condensed" style="margin-bottom:0px;">
											<thead>
												<tr>
													<th>Datensatz</th>
													<th>Beschreibung</th>
													<th>Legende</th>
													<th
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														Lebenszeit-Beginn</th>
													<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
												</tr>
											</thead>

											<tbody>

												<tr
													ng-repeat='loi in $ctrl.kommonitorDataExchangeServiceInstance.displayableGeoresources_keywordFiltered_forAlphabeticalDisplay.loiData'>
													<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="loi.datasetName" ng-model="loi.isSelected"
																ng-change="handleLoiOnMap(loi)">

															<b>&nbsp;&nbsp;{{::loi.datasetName}}</b> <a href="" ng-show="loi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(loi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
														</label>
													</td>
													<td>
														<p>{{::loi.metadata.description}}</p>
													</td>
													<td class="text-center">
														<div align="center">
															<i
																style="width:15px; height:15px; background:{{::loi.loiColor}}; display:inherit;">
															</i>
														</div>
													</td>
													<td
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														<select style="font-size: 11px; width:135px; padding: 0px;"
															ng-model="loi.selectedDate"
															ng-change="onChangeSelectedDate(loi)"
															ng-options="date as date.startDate for date in loi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
															ng-init="loi.selectedDate = loi.availablePeriodsOfValidity[loi.availablePeriodsOfValidity.length - 1]"
															class="form-control" required>
														</select>
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<a href="" ng-click="getExportLinkForLoi(loi)"
															title="Download Features as GeoJSON"><i
																class="fas fa-file-download fa-lg"></i></a>
														
														<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(loi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
														<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
													</td>
												</tr>
											</tbody>
										</table>
									</div>

								</div>

							</div>
							<!-- /.box-body -->
						</div>
						<!-- /.box -->


						<!-- AREAS OF INTEREST -->
						<div class="box box-primary collapsed-box" ng-if="isGeoresourceInfrastructureEnabled('aoi')">
							<div class="box-header with-border">
								<h3 class="box-title">Areas of Interest</h3>

								<div class="box-tools pull-right">
									<button type="button" class="btn btn-box-tool" data-widget="collapse"><i
											class="fa fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">

								<div class="">

									<div id="aoiInputForm">

										<table class="table table-condensed" style="margin-bottom:0px;">
											<thead>
												<tr>
													<th>Datensatz</th>
													<th>Beschreibung</th>
													<th>Legende</th>
													<th
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														Lebenszeit-Beginn</th>
													<th ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons">Export</th>
												</tr>
											</thead>

											<tbody>

												<tr
													ng-repeat='aoi in $ctrl.kommonitorDataExchangeServiceInstance.displayableGeoresources_keywordFiltered_forAlphabeticalDisplay.aoiData'>
													<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
													<td>
														<label class='checkbox-inline'><input type="checkbox"
																value="aoi.datasetName" ng-model="aoi.isSelected"
																ng-change="handleAoiOnMap(aoi)">

															<b>&nbsp;&nbsp;{{::aoi.datasetName}}</b> <a href="" ng-show="aoi.isSelected" title="Auf Layer zoomen" ng-click="zoomToLayer(aoi)"><i style="font-size:1.5em;" class="fas fa-search-location"></i></a>
													
														</label>
													</td>
													<td>
														<p>{{::aoi.metadata.description}}</p>
													</td>
													<td class="text-center">
														<div align="center">
															<i
																style="width:15px; height:15px; background:{{::aoi.aoiColor}}; display:inherit;">
															</i>
														</div>
													</td>
													<td
														ng-if="dateSelectionType.selectedDateType === dateSelectionType_valuePerDataset">
														<select style="font-size: 11px; width:135px; padding: 0px;"
															ng-model="aoi.selectedDate"
															ng-change="onChangeSelectedDate(aoi)"
															ng-options="date as date.startDate for date in aoi.availablePeriodsOfValidity | orderBy: 'startDate' | unique: 'startDate'"
															ng-init="aoi.selectedDate = aoi.availablePeriodsOfValidity[aoi.availablePeriodsOfValidity.length - 1]"
															class="form-control" required>
														</select>
													</td>
													<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
														<a href="" ng-click="getExportLinkForAoi(aoi)"
															title="Download Features as GeoJSON"><i
																class="fas fa-file-download fa-lg"></i></a>

														<a href="" ng-click="$ctrl.kommonitorDataExchangeServiceInstance.downloadMetadataPDF_georesource(aoi)"
																		title="Download Metadata PDF"><i class="fas fa-file-export fa-lg"></i></a>
														<!-- <a ng-href="getExportLinkForAoi(aoi)" title="Download Features as GeoJSON"><i class="fas fa-file-download fa-lg"></i></a> -->
													</td>
												</tr>
											</tbody>
										</table>
									</div>

								</div>

							</div>
							<!-- /.box-body -->
						</div>
						<!-- /.box -->


						<!-- WMS -->
						<div class="box box-primary collapsed-box" ng-if="isGeoresourceGeoserviceEnabled('wms')">
							<div class="box-header with-border">
								<h3 class="box-title">Web Map Service (WMS)</h3>

								<div class="box-tools pull-right">
									<button type="button" class="btn btn-box-tool" data-widget="collapse"><i
											class="fa fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">

								<div id="wmsInputForm">

									<table class="table table-condensed" style="margin-bottom:0px;">
										<thead>
											<tr>
												<th>Datensatz</th>
												<th>Beschreibung</th>
												<th>WMS URL</th>
												<th>Legende</th>
											</tr>
										</thead>

										<tbody>

											<tr
												ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.displayableGeoresources_keywordFiltered_forAlphabeticalDisplay.wmsData'>
												<!-- <span style="font-size:1.8em;" class="glyphicon glyphicon-th" aria-hidden="true"></span> -->
												<td>
													<label class='checkbox-inline'><input type="checkbox"
															value="dataset.title" ng-model="dataset.isSelected"
															ng-change="handleWmsOnMap(dataset)">

														<b ng-bind-html="::dataset.title"></b>
													</label>
												</td>
												<td>
													<p ng-bind-html="::dataset.description"></p>
												</td>
												<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
													<div align="center">
														<a href="{{::dataset.url}}service=WMS&request=GetCapabilities&version=1.3.0"
															title="WMS GetCapabilities URL" rel='noopener noreferrer'
															target='_blank'><i
																class="fas fa-cloud-download-alt"></i></a>
													</div>
												</td>
												<td class="text-center">
													<div ng-if="! dataset.showLegend">
														<button class="btn btn-sm btn-primary"
															ng-click="dataset.showLegend = true;">laden</button>
													</div>
													<div ng-if="dataset.showLegend">
														<img
															src="{{::dataset.url}}service=WMS&REQUEST=GetLegendGraphic&VERSION=1.0.0&FORMAT=image/png&LAYER={{::dataset.layerName}}">
													</div>
												</td>
											</tr>
										</tbody>
									</table>
								</div>

								<br />

								<!-- <div align="center">

												<button class="btn btn-success" type="button" data-toggle="modal" data-target="#modal-add-wms">Eigenen WMS hinzuladen</button>

											</div> -->

							</div>
							<!-- /.box-body -->

						</div>
						<!-- /.box -->

						<!-- WfS -->
						<div class="box box-primary collapsed-box" ng-if="isGeoresourceGeoserviceEnabled('wfs')">
							<div class="box-header with-border">
								<h3 class="box-title">Web Feature Service (WFS)</h3>

								<div class="box-tools pull-right">
									<button type="button" class="btn btn-box-tool" data-widget="collapse"><i
											class="fa fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="box-body">

								<p>Hinzuladen eines WFS kann je nach Objektanzahl und -komplexität einige Moment dauern.
									Die Features werden zudem nach dem aktuellen Raumausschnitt der Kartendarstellung
									gefiltert abgefragt.</p>

								<div id="wfsInputForm">

									<table class="table table-condensed" style="margin-bottom:0px;">
										<thead>
											<tr>
												<th>Datensatz</th>
												<th>Beschreibung</th>
												<th>auf aktuellen Raumausschnitt beschr&auml;nken</th>
												<th>WFS URL</th>
												<th>Legende</th>
											</tr>
										</thead>

										<tbody>

											<tr
												ng-repeat='dataset in $ctrl.kommonitorDataExchangeServiceInstance.displayableGeoresources_keywordFiltered_forAlphabeticalDisplay.wfsData'>
												<td>
													<label class='checkbox-inline'><input type="checkbox"
															value="dataset.title" ng-model="dataset.isSelected"
															ng-change="handleWfsOnMap(dataset)">

														<b ng-bind-html="::dataset.title"></b>
													</label>
												</td>
												<td>
													<p ng-bind-html="::dataset.description"></p>
												</td>
												<td>
													<label class="switch">
														<input id="filterCheckbox" type="checkbox"
															ng-model="dataset.filterFeaturesToMapBBOX"
															ng-checked="dataset.filterFeaturesToMapBBOX"></input>
														<span class="switchslider round"></span>
													</label>
												</td>
												<td ng-if="$ctrl.kommonitorDataExchangeServiceInstance.showGeoresourceExportButtons" class="text-center">
													<div align="center">
														<a href="{{::dataset.url}}service=WFS&request=GetCapabilities&version=1.1.0"
															title="WFS GetCapabilities URL" rel='noopener noreferrer'
															target='_blank'><i
																class="fas fa-cloud-download-alt"></i></a>
													</div>
												</td>
												<td class="text-center">
													<div>
														<div ng-show="dataset.geometryType==='AOI'">
															<div class="input-group colorpicker-component">
																<input type="text" style="display:none;"
																	class="form-control input-sm"
																	ng-model="dataset.aoiColor"
																	ng-change="adjustWfsLayerColor(dataset)"
																	placeholder="WFS Darstellungsfarbe" required />
																<span title="Klicken, um die Farbe anzupassen"
																	style="border: 1px solid #ccc;"
																	class="input-group-addon"><i></i></span>
															</div>
														</div>
														<div ng-show="dataset.geometryType==='LOI'">
															<div class="input-group colorpicker-component">
																<input type="text" style="display:none;"
																	class="form-control input-sm"
																	ng-model="dataset.loiColor"
																	ng-change="adjustWfsLayerColor(dataset)"
																	placeholder="WFS Darstellungsfarbe" required />
																<span title="Klicken, um die Farbe anzupassen"
																	style="border: 1px solid #ccc;"
																	class="input-group-addon"><i></i></span>
															</div>
														</div>
														<div ng-show="dataset.geometryType==='POI'">
															<div align="center">
																<div
																	class="awesome-marker-legend awesome-marker-legend-icon-{{::dataset.poiMarkerColor}}">
																	<span
																		style="margin-left:3px; margin-right:3px; margin-top: 2px;  font-size:1.2em; color:{{::dataset.poiSymbolColor}};"
																		class="glyphicon glyphicon-{{::dataset.poiSymbolBootstrap3Name}}"
																		aria-hidden="true"></span>
																</div>
															</div>
														</div>
													</div>
												</td>
											</tr>
										</tbody>
									</table>
								</div>

								<br />

								<!-- <div align="center">

															<button class="btn btn-success" type="button" data-toggle="modal" data-target="#modal-add-wfs">Eigenen WFS hinzuladen</button>

														</div> -->

							</div>
							<!-- /.box-body -->

						</div>
						<!-- /.box -->


					</div>
				</uib-tab>
			</uib-tabset>

		</div>

	</div>

</div>