<div id="adminTopicsContent">
  <div align="center">
    <div class="loading-overlay-admin-panel" [class.ng-hide]="!loadingData">
      <span class="glyphicon glyphicon-refresh icon-spin"></span>
    </div>
  </div>

  <!-- Content Header (Page header) -->
  <section class="content-header">
    <h1>
      Themenverwaltung
      <small>Management der Themenhierarchien für Indikatoren und Georessourcen</small>
    </h1>
  </section>

  <!-- Main content -->
  <section class="content container-fluid">
    <b>Zeige IDs</b>
    &nbsp;
    <label class="switch">
      <input type="checkbox" [(ngModel)]="showTopicIds">
      <span class="switchslider round"></span>
    </label>

    <br />

    <div class="box box-primary" id="indicatorTopicsManagement">
      <div class="box-header with-border">
        <h3 class="box-title">Themenhierarchie - Indikatoren</h3>
        <div class="box-tools pull-right">
          <button type="button" class="btn btn-box-tool" data-widget="collapse">
            <i class="fa fa-minus"></i>
          </button>
        </div>
      </div>

      <div class="box-body">
        <div class="just-padding">
          <div class="list-group list-group-root well">
            <div *ngFor="let mainTopic of dataExchangeService.availableTopics | filter:{topicType:'main'} | filter:{topicResource:'indicator'}">
              <div class="list-group-item list-group-item-default" style="background: #2171b5; color: white;">
                <a [id]="mainTopic.topicId" href="" [title]="mainTopic.topicDescription"
                  class="collapseTrigger" style="color: white;"
                  (click)="isCollapsed_mainTopic = !isCollapsed_mainTopic"
                  [attr.data-init]="true">
                  <i class="glyphicon glyphicon-chevron-right"></i>{{mainTopic.topicName}}
                </a>

                <div *ngIf="showTopicIds" style="display: inline-block;">
                  (ID: {{mainTopic.topicId}})
                </div>

                <div class="btn-group btn-group-sm" style="margin-left: 30px;">
                  <button type="button" class="btn btn-warning" (click)="onClickEditTopic(mainTopic)"
                    data-toggle="modal" data-target="#modal-edit-topic">
                    <i class="fas fa-pencil-alt"></i>
                  </button>
                  <button type="button" class="btn btn-danger"
                    (click)="onClickDeleteTopic(mainTopic)" data-toggle="modal"
                    data-target="#modal-delete-topic">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </div>

              <div class="list-group collapse" [class.show]="!isCollapsed_mainTopic">
                <div *ngFor="let subTopic of mainTopic.subTopics">
                  <div class="list-group-item list-group-item-default"
                    style="background: #6baed6; color: white;">
                    <a [id]="subTopic.topicId" class="collapseTrigger" style="color: white;"
                      [title]="subTopic.topicDescription" href=""
                      (click)="isCollapsed_subTopic = !isCollapsed_subTopic"
                      [attr.data-init]="true">
                      <i class="glyphicon glyphicon-chevron-right"></i>{{subTopic.topicName}}
                    </a>

                    <div *ngIf="showTopicIds" style="display: inline-block;">
                      (ID: {{subTopic.topicId}})
                    </div>

                    <div class="btn-group btn-group-sm" style="margin-left: 30px;">
                      <button type="button" class="btn btn-warning"
                        (click)="onClickEditTopic(subTopic)" data-toggle="modal"
                        data-target="#modal-edit-topic">
                        <i class="fas fa-pencil-alt"></i>
                      </button>
                      <button type="button" class="btn btn-danger"
                        (click)="onClickDeleteTopic(subTopic)" data-toggle="modal"
                        data-target="#modal-delete-topic">
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </div>

                  <!-- Add sub-topic form -->
                  <div class="list-group-item list-group-item-success"
                    *ngIf="!isCollapsed_subTopic" style="border-top: double;">
                    <form role="form" class="form-group" data-toggle="validator"
                      style="margin-bottom: 0px;">
                      <div class="row">
                        <div class="col-md-3">
                          <button class="btn btn-success btn-sm"
                            (click)="onAddSubTopic(mainTopic, 'indicator')"
                            [disabled]="!mainTopic.newSubTopicTitle_indicator || !mainTopic.newSubTopicDescription_indicator">
                            <i class="fas fa-plus"></i> &nbsp; &nbsp;
                            Unterthema hinzufügen
                          </button>
                        </div>
                        <div class="col-md-4">
                          <input style="width:100%;" class="form-control"
                            type="text" placeholder="Titel des Unterthemas"
                            [(ngModel)]="mainTopic.newSubTopicTitle_indicator"
                            name="newSubTopicTitle_indicator" required>
                          <div class="help-block with-errors"></div>
                        </div>
                        <div class="col-md-5">
                          <textarea style="width:100%;" rows="1"
                            class="form-control" type="text"
                            placeholder="Beschreibung des Unterthemas"
                            [(ngModel)]="mainTopic.newSubTopicDescription_indicator"
                            name="newSubTopicDescription_indicator" required></textarea>
                          <div class="help-block with-errors"></div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>

            <!-- Add main topic form -->
            <div class="list-group-item list-group-item-success" style="border-top: double;">
              <form role="form" class="form-group" data-toggle="validator"
                style="margin-bottom: 0px;">
                <div class="row">
                  <div class="col-md-3">
                    <button class="btn btn-success btn-sm"
                      (click)="onAddMainTopic('indicator')"
                      [disabled]="!newMainTopicTitle_indicator || !newMainTopicDescription_indicator">
                      <i class="fas fa-plus"></i> &nbsp; &nbsp;
                      Hauptthema hinzufügen
                    </button>
                  </div>
                  <div class="col-md-4">
                    <input style="width:100%;" class="form-control"
                      type="text" placeholder="Titel des Hauptthemas"
                      [(ngModel)]="newMainTopicTitle_indicator"
                      name="newMainTopicTitle_indicator" required>
                    <div class="help-block with-errors"></div>
                  </div>
                  <div class="col-md-5">
                    <textarea style="width:100%;" rows="1"
                      class="form-control" type="text"
                      placeholder="Beschreibung des Hauptthemas"
                      [(ngModel)]="newMainTopicDescription_indicator"
                      name="newMainTopicDescription_indicator" required></textarea>
                    <div class="help-block with-errors"></div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error Alert -->
    <div id="topicsErrorAlert" class="alert alert-danger alert-dismissible" style="display: none;">
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
      <h4><i class="icon fa fa-ban"></i> Fehler!</h4>
      <div [innerHTML]="errorMessagePart"></div>
    </div>
  </section>
</div> 